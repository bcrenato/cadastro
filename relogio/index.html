<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Relógio de Oração</title>
  <!-- Carrega Firebase App + Database -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js"></script>
  <!-- Carrega sua configuração -->
  <script src="../firebase-config.js"></script>
</head>
<body>
  <h1>Relógio de Oração</h1>
  <div id="horarios"></div>

  <script>
    // Agora usamos a referência que expusemos no window.firebase
    const db = window.firebase.db;
    
    // Importa as funções necessárias do Firebase
    const { ref, onValue, update } = firebase.database;

    function renderHorarios(snapshot) {
      const container = document.getElementById('horarios');
      container.innerHTML = '';
      snapshot.forEach(child => {
        const h = child.key;
        const data = child.val();
        const btn = data.reservado
          ? `<button disabled>${h} — Reservado</button>`
          : `<button onclick="reservar('${h}')">${h} — Reservar</button>`;
        container.innerHTML += `<div>${btn}</div>`;
      });
    }

    // Observa mudanças nos horários
    onValue(ref(db, 'horarios'), renderHorarios);

    function reservar(horario) {
      const nome = prompt('Seu nome:');
      if (!nome) return;
      update(ref(db, `horarios/${horario}`), {
        reservado: true,
        nome_reserva: nome
      }).then(() => alert('Reserva confirmada!'));
    }
  </script>
</body>
</html>
