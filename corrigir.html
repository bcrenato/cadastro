âœ… Perfeito â€” vou montar para vocÃª um corrigir.html que, ao abrir logado como admin, percorre todos os usuÃ¡rios do Realtime Database e coloca isEnabled: true onde estiver faltando.

Assim vocÃª sÃ³ precisa abrir a pÃ¡gina, ela corrige todos os usuÃ¡rios e avisa que terminou.

Segue o cÃ³digo completo do corrigir.html:

ğŸ“„ corrigir.html

<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Corrigir UsuÃ¡rios - Sistema Igreja</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="p-4">
<h1>Corrigir UsuÃ¡rios Antigos</h1>
<div id="status" class="mt-3 alert alert-info">Processando...</div>

<script type="module">
import { db } from './firebase-config.js';
import { ref, get, set } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js';
import { checkAdminAuth } from './auth.js';

async function corrigirUsuarios() {
  const status = document.getElementById('status');

  const autorizado = await checkAdminAuth();
  if (!autorizado) {
    status.textContent = 'VocÃª nÃ£o tem permissÃ£o para executar esta operaÃ§Ã£o.';
    status.className = 'mt-3 alert alert-danger';
    return;
  }

  try {
    const usersRef = ref(db, 'users');
    const snapshot = await get(usersRef);

    if (!snapshot.exists()) {
      status.textContent = 'Nenhum usuÃ¡rio encontrado.';
      status.className = 'mt-3 alert alert-warning';
      return;
    }

    let count = 0;
    snapshot.forEach(child => {
      const data = child.val();
      if (!data.isEnabled) {
        set(ref(db, `users/${child.key}/isEnabled`), true);
        count++;
      }
    });

    if (count > 0) {
      status.textContent = `Corrigido! ${count} usuÃ¡rios foram habilitados.`;
      status.className = 'mt-3 alert alert-success';
    } else {
      status.textContent = 'Todos os usuÃ¡rios jÃ¡ estavam habilitados.';
      status.className = 'mt-3 alert alert-success';
    }
  } catch (err) {
    console.error(err);
    status.textContent = 'Erro ao corrigir usuÃ¡rios.';
    status.className = 'mt-3 alert alert-danger';
  }
}

corrigirUsuarios();
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

ğŸ“‹ Como usar

1ï¸âƒ£ FaÃ§a upload desse arquivo junto com seus outros arquivos.
2ï¸âƒ£ Abra no navegador (logado como admin) â†’ corrigir.html.
3ï¸âƒ£ Ela mostra:
â€” Quantos usuÃ¡rios foram corrigidos (habilitados).
â€” Ou avisa se jÃ¡ estavam todos habilitados.

Quer que eu jÃ¡ gere tambÃ©m o ZIP com o corrigir.html junto com os outros arquivos finais?
